Date: 28th August 2024
Date Modified: 28th August 2024
File Folder: Week 1
#Electronics

```ad-abstract
title: Today's Topics
collapse: open

- Microcontrollers Cont.

```

# Microcontrollers

## Interrupts: Mechanisms for Real-Time Applications

**Interrupts** are mechanism by which other modules (e.g. a button, a sensor, software) may interrupt the normal sequencing of the processor

Provided to improve processor utilization
- Most I/O devices are slower than the rpocessor
- Processor must pause to wait for device
- Wasteful use of the processor

![[ERTA - Week 1 Day 2 2024-08-28 13.04.19.excalidraw]]

### Classes of Interrupts

| Type             | Description                                                                                                                 |     |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------- | --- |
| Program          | Generated by some condition that occurs as a reuslt of insturction execution                                                |     |
| Timer            | Generated by a timer within the processor. This allows the operating system to perform certain functions on a regular basis |     |
| I/O              | Generated by an I/O controller, to signal normal operations                                                                 |     |
| Hardware Failure | Self-explanatory                                                                                                            |     |

# Microcontroller Architecture

![[ERTA - Week 1 Day 2 2024-08-28 13.11.57.excalidraw]]

## Types of System Architecture

There are **TWO** main types:

**Von-Neumann**

![[ERTA - Week 1 Day 2 2024-08-28 13.13.56.excalidraw]]

**Harvard**

![[ERTA - Week 1 Day 2 2024-08-28 13.14.58.excalidraw]]

```ad-important
The main difference between the two is that Harvard has a *separate* bus for data and instructions
```

## Instruction Set Architecture (ISA)

ISAs define how software interact with given hardware

An ISA might define the following for a given CPU
- Supported instructions
- SUpported data types
- Registers
- Database bus size
- HOw the CPU manages memory
- I/O management

```ad-example
- x86 (desktop)
- ARM (mobile)
- PowerPC (cars)
- SPRAC (server)
```

## Registers

Registers are the super fast storage in a CPU
- Very expensive, very fast
- Can contain:
	- Data
	- Addresses
	- Instructions
	- Process state information

![[ERTA - Week 1 Day 2 2024-08-28 13.23.39.excalidraw]]

```ad-note
Typically placed on the CPU die
```

### Registers for ARM ISA

**General Purpose**: R0 through R12: 32-bit

**Special Registers**:
- R13: *Stack register (SP)* holds address of the top of the stack. This can be either:
	- Main stack pointer (MSP)
	- Process stack pointer (SPS)
- R14: *Link Register* holds return address for subroutines (used for functions)
- R15: *Program Counter* holds the address of the next instruction to execute 

![[main-qimg-e4cb791cf3f72d20bf6d11d9b950ce4a.png]]

![[ERTA - Week 1 Day 2 2024-08-28 13.29.32.excalidraw]]

#### Program Status Register

The PSR controls and reflects that state of the processor. It contains **three** registers:

1. Application Program Status Register (APSR)
2. The Interrupt Program Status Register (IPSR)
3. The Execution Program Status Register (EPSR)

![[3-s2.0-B9780128207352000044-f04-07-9780128207352.jpg]]

##### APSR

The `N`, `Z`, `V`, `C`, and `Q` bits give informaiton about the reuslt of a previous ALU operaiton.

| Code | Bits     | Indicates          |
| ---- | -------- | ------------------ |
| N    | negative | Reuslt is negative |
| Z    | zero     |                    |

#comebacklater 

##### IPSR

Holds the number for which interrupt was being handled by the interrupt service routine. 

##### EPSR

```ad-note
Out of the scope of this class
```

#### Other Special Registers

**PRIMASK**: Allows or disallows interrupts
- Contains other features as well

**FAULTMASK**: Allows or disallows faults and interrupts

**BASEPRI**: The priority of executing software
- Lower the number: the higher the priority


### Memory Mapping

Every ISA has a different amounts of memory:
- Amount of RAM
- Amount of ROM
- Amount of I/O

To the programmer, this memory appears as a continuous block of memory to pull from.

```ad-important
Each ISA must map physical memory to this virtual memory
```

![[Pasted image 20240828134018.png]]

#### Memory Array Architecture

**Input**: an address $0$ through $n$

**Output:** A number between $0$ and $2^m$

![[Pasted image 20240828134257.png]]

#### Big-endian versus Little-Endian

```ad-question
Let's say we have a number with 4 bytes. How do we physically arrang ethis number into memory?
```

`0x0A0B0C0D` $\rightarrow$ \[ \] \[\ ] \[ \] \[ \]

**Option-One**: *Big endian*
- We put he most significant digit (biggest) in first

**Option-Two**: *Little endian*
- WE put the least significant digit in first

![[Pasted image 20240828134608.png]]

```ad-note
ARM Cortex uses *little* endian
```



